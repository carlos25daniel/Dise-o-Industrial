<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Malla Curricular Interactiva con Gatitos - Karla</title>
<style>
  /* --- Colores seg√∫n tu pedido: p√∫rpura, malva, canario, narciso y verde olivo --- */
  * { box-sizing: border-box; }
  body {
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    background: #fafafa;
    margin: 0; padding: 30px 20px; color: #333;
  }
  h1 {
    text-align: center;
    color: #800080; /* p√∫rpura */
    font-weight: 900;
    margin-bottom: 40px;
    font-size: 2.6rem;
    letter-spacing: 1.2px;
  }
  h2 {
    color: #808000; /* verde olivo */
    font-weight: 700;
    font-size: 1.8rem;
    margin-bottom: 16px;
    border-bottom: 3px solid #808000;
    padding-bottom: 6px;
    max-width: 600px;
    margin: 0 auto 24px auto;
  }
  .grid {
    max-width: 900px;
    margin: 0 auto 50px auto;
    display: grid;
    grid-template-columns: repeat(auto-fit,minmax(180px,1fr));
    gap: 18px;
  }
  .materia {
    background: #E0B0FF; /* malva */
    border-radius: 14px;
    padding: 22px 18px;
    box-shadow: 0 6px 14px rgba(128,0,128,0.15);
    cursor: pointer;
    user-select: none;
    transition: background-color 0.4s ease, box-shadow 0.3s ease, transform 0.2s ease;
    color: #2c1a57;
    font-weight: 700;
    font-size: 1.1rem;
    position: relative;
    text-align: center;
    min-height: 100px;
    display: flex;
    align-items: center;
    justify-content: center;
    line-height: 1.2;
  }
  .materia.activa:hover {
    background-color: #d0a8ff;
    box-shadow: 0 10px 22px rgba(128,0,128,0.3);
    transform: translateY(-6px);
  }
  .materia.aprobada {
    background: #FFFF99; /* canario */
    color: #5a5500;
    box-shadow: 0 6px 16px rgba(249,166,2,0.5); /* narciso */
  }
  .materia.aprobada::after {
    content: "‚úî";
    position: absolute;
    top: 12px;
    right: 14px;
    font-size: 22px;
    color: #F9A602; /* narciso */
    font-weight: 900;
    text-shadow: 0 0 6px #dca600;
  }
  .materia.bloqueada {
    background: #f0f0f0;
    color: #aaa;
    cursor: default;
    box-shadow: none;
    font-weight: 600;
  }
  .materia.pequena {
    font-size: 0.95rem;
  }
  .materia[title] {
    position: relative;
  }
  .materia[title]:hover::after {
    content: attr(title);
    position: absolute;
    bottom: -30px;
    left: 50%;
    transform: translateX(-50%);
    background: #800080cc;
    color: white;
    padding: 4px 9px;
    font-size: 0.8rem;
    border-radius: 5px;
    white-space: nowrap;
    pointer-events: none;
    opacity: 1;
    transition: opacity 0.2s;
  }
  @media (max-width: 480px) {
    h1 { font-size: 1.9rem; }
    h2 { font-size: 1.3rem; }
    .materia { font-size: 1rem; min-height: 80px; }
  }

  /* --- Contenedor para mensaje gatuno --- */
  #mensaje-gatito {
    position: fixed;
    bottom: 30px;
    right: 30px;
    background: #800080cc; /* p√∫rpura */
    color: #fff;
    padding: 16px 22px;
    border-radius: 16px;
    box-shadow: 0 4px 12px #800080bb;
    font-size: 1.2rem;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 12px;
    z-index: 9999;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.4s ease;
    user-select: none;
  }
  #mensaje-gatito.mostrar {
    opacity: 1;
    pointer-events: auto;
  }
  #mensaje-gatito .emoji {
    font-size: 2.6rem;
    user-select: none;
    position: relative;
  }
  /* K encima del gato (usando pseudo elemento) */
  #mensaje-gatito .emoji.k {
    position: relative;
  }
  #mensaje-gatito .emoji.k::before {
    content: "K";
    position: absolute;
    top: -10px;
    left: 50%;
    transform: translateX(-50%);
    font-weight: 900;
    font-size: 1.5rem;
    color: #F9A602; /* narciso */
    text-shadow: 0 0 4px #dca600;
    user-select: none;
  }
</style>
</head>
<body>

<h1>Malla Curricular Interactiva</h1>

<div id="contenedor-malla"></div>

<!-- Mensaje gatito -->
<div id="mensaje-gatito" aria-live="polite" role="alert" style="display:none;">
  <div class="emoji k">üê±</div>
  <div id="mensaje-texto"></div>
</div>

<script>
  const materiasPorAno = {
    "Nivelaci√≥n": [
      {id:"Nivelacion", nombre:"Nivelaci√≥n (CBC)", req: []},
      {id:"Proyectual1", nombre:"Proyectual 1", req:["Nivelacion"]},
      {id:"Proyectual2", nombre:"Proyectual 2", req:["Proyectual1"]},
      {id:"Dibujo", nombre:"Dibujo", req:["Proyectual1"]},
      {id:"Sociedad", nombre:"Sociedad y Estado", req:["Proyectual1"]},
      {id:"Pensamiento", nombre:"Pensamiento Cient√≠fico", req:["Proyectual1"]},
      {id:"Matematica", nombre:"Matem√°tica", req:["Proyectual1"]},
      {id:"Semiologia", nombre:"Semiolog√≠a", req:["Proyectual1"]}
    ],
    "Primer A√±o": [
      {id:"TDI1", nombre:"TDI1 - Taller Dise√±o Industrial 1", req:["Proyectual2","Dibujo","Sociedad","Pensamiento","Matematica","Semiologia"]},
      {id:"M1", nombre:"M1 - Morfolog√≠a 1", req:["Proyectual2","Dibujo","Sociedad","Pensamiento","Matematica","Semiologia"]},
      {id:"AP", nombre:"AP - An√°lisis de Productos", req:["Proyectual2","Dibujo","Sociedad","Pensamiento","Matematica","Semiologia"]},
      {id:"T1", nombre:"T1 - Tecnolog√≠a 1", req:["Proyectual2","Dibujo","Sociedad","Pensamiento","Matematica","Semiologia"]},
      {id:"MAT1", nombre:"MAT1 - Matem√°tica 1", req:["Proyectual2","Dibujo","Sociedad","Pensamiento","Matematica","Semiologia"]},
      {id:"F1", nombre:"F1 - F√≠sica 1", req:["Proyectual2","Dibujo","Sociedad","Pensamiento","Matematica","Semiologia"]}
    ],
    "Segundo A√±o": [
      {id:"TDI2", nombre:"TDI2 - Taller Dise√±o Industrial 2", req:["TDI1","AP","T1"]},
      {id:"M2", nombre:"M2 - Morfolog√≠a 2", req:["TDI1","M1"]},
      {id:"T2", nombre:"T2 - Tecnolog√≠a 2", req:["T1","F1"]},
      {id:"Ergo", nombre:"Ergonom√≠a y Factores Humanos", req:["AP","TDI1","F1"]},
      {id:"HD1", nombre:"Historia del Dise√±o Industrial 1", req:["Nivelacion"]}
    ],
    "Tercer A√±o": [
      {id:"TDI3", nombre:"TDI3 - Taller Dise√±o Industrial 3", req:["TDI2","M1","T2","Ergo","MAT1","F1"]},
      {id:"M3", nombre:"M3 - Morfolog√≠a 3", req:["TDI2","M2","T1","MAT1","F1"]},
      {id:"T3", nombre:"T3 - Tecnolog√≠a 3", req:["TDI1","M1","MAT1","T1","F1","AP","T2"]},
      {id:"F2", nombre:"F2 - F√≠sica 2", req:["TDI1","M1","MAT1","T1","F1","AP"]},
      {id:"HDI2", nombre:"Historia del Dise√±o Industrial 2", req:["TDI1","M1","T1","AP","HD1","MAT1","F1"]}
    ],
    "Cuarto A√±o": [
      {id:"TDI4", nombre:"TDI4 - Taller Dise√±o Industrial 4", req:["TDI3","M2","T3","F2","Ergo","HDI1","T2"]},
      {id:"T4", nombre:"T4 - Tecnolog√≠a 4", req:["M2","TDI2","T2","Ergo","T3","F2","HDI1","F2","T3"]},
      {id:"SAD", nombre:"Sociolog√≠a aplicada al dise√±o", req:["TDI2","T2","M2","Ergo","HDI1","HDI2"]},
      {id:"GI", nombre:"Gesti√≥n Industrial", req:["TDI2","T2","M2","Ergo","HDI1","HDI2"]}
    ],
    "Quinto A√±o": [
      {id:"PF", nombre:"PF - Proyecto Final", req:["TDI4","T3","F2","HDI2","M3","T4"]},
      {id:"MID", nombre:"MID - Metodolog√≠a", req:["M2","TDI2","T2","Ergo","T3","F2","HDI1","F2","T3"]},
      {id:"GP", nombre:"GP - Gesti√≥n de Proyecto", req:["M2","TDI2","T2","Ergo","T3","F2","HDI1","F2","T3"]},
      {id:"PPA", nombre:"PPA", req:["TDI3","T2","M2","Ergo","HDI1","F2","HDI2"]},
      {id:"LG", nombre:"LG - Legislaci√≥n", req:["TDI3","T2","M3","Ergo","HDI1","F2","T3","HDI2"]}
    ],
    "Electivas y Optativas": [
      {id:"Dise√±oInterfases", nombre:"Dise√±o de Interfaces y Gr√°fica Aplicada", req:["TDI3","T2","M2","Ergo","F2","HDI2"]},
      {id:"Mercadotecnia", nombre:"Mercadotecnia y Gesti√≥n Empresaria", req:["TDI3","T2","M2","Ergo","F2","HDI2"]},
      {id:"AspectosEconomicos", nombre:"Aspectos Econ√≥micos del Dise√±o", req:["TDI3","T2","M2","Ergo","F2","HDI2"]},
      {id:"Dise√±oInnovacion", nombre:"Dise√±o e Innovaci√≥n", req:["TDI3","T2","M2","Ergo","F2","HDI2"]},
      {id:"Dise√±oSustentabilidad", nombre:"Dise√±o para la Sustentabilidad", req:["TDI3","T2","M2","Ergo","F2","HDI2"]},
      {id:"ErgonomiaUX", nombre:"Ergonom√≠a y Experiencia de Usuario", req:["TDI3","T2","M2","Ergo","F2","HDI2"]},
      {id:"Optativa1", nombre:"Optativa 1", req:["TDI3","T2","M2","Ergo","F2","HDI2"]},
      {id:"Optativa2", nombre:"Optativa 2", req:["TDI3","T2","M2","Ergo","F2","HDI2"]}
    ]
  };

  // Carga progreso guardado o vacio
  let progreso = JSON.parse(localStorage.getItem("progresoMalla")) || {};

  // Verifica si todas las materias requeridas est√°n aprobadas
  function puedeAcceder(reqs){
    return reqs.every(r => progreso[r]);
  }

  // Mensaje gatuno o triste seg√∫n apruebes o desmarques
  function mostrarMensaje(aprobado){
    const mensajeDiv = document.getElementById("mensaje-gatito");
    const texto = document.getElementById("mensaje-texto");

    if(aprobado){
      mensajeDiv.querySelector(".emoji").textContent = "üê±"; // gatito
      mensajeDiv.querySelector(".emoji").classList.add("k");
      const frasesBuenas = [
        "Lo hiciste bien mi amor üíú",
        "¬°Felicitaciones, hermosa! ü•∞",
        "Eres incre√≠ble, sigue as√≠ üíñ",
        "¬°Brillaste, mi reina! ‚ú®",
        "¬°Orgullo puro! üòª"
      ];
      const frase = frasesBuenas[Math.floor(Math.random()*frasesBuenas.length)];
      texto.textContent = frase;
    } else {
      mensajeDiv.querySelector(".emoji").textContent = "üòø"; // carita triste
      mensajeDiv.querySelector(".emoji").classList.remove("k");
      // Mensaje especial "No hay coito üòø"
      const frase = "No hay coito üòø";
      texto.textContent = frase;
    }

    mensajeDiv.style.display = "flex";
    setTimeout(() => {
      mensajeDiv.style.opacity = "1";
      mensajeDiv.classList.add("mostrar");
    }, 10);

    setTimeout(() => {
      mensajeDiv.classList.remove("mostrar");
      setTimeout(() => {
        mensajeDiv.style.display = "none";
      }, 400);
    }, 4000);
  }

  // Crear la secci√≥n (a√±o) con materias
  function crearSeccion(nombreAno, materias) {
    const contenedor = document.createElement("section");
    const titulo = document.createElement("h2");
    titulo.textContent = nombreAno;
    contenedor.appendChild(titulo);

    const grid = document.createElement("div");
    grid.className = "grid";

    materias.forEach(m => {
      const div = document.createElement("div");
      div.className = "materia";
      if(m.nombre.length > 25) div.classList.add("pequena");
      div.textContent = m.nombre;
      div.title = "Haz clic para marcar/desmarcar aprobado";

      if(progreso[m.id]){
        div.classList.add("aprobada");
      } else if(puedeAcceder(m.req)){
        div.classList.add("activa");
      } else {
        div.classList.add("bloqueada");
      }

      div.onclick = () => {
        if(div.classList.contains("bloqueada")) return;

        let aprobadaAntes = div.classList.contains("aprobada");

        if(aprobadaAntes){
          delete progreso[m.id];
          mostrarMensaje(false);
        } else {
          progreso[m.id] = true;
          mostrarMensaje(true);
        }
        localStorage.setItem("progresoMalla", JSON.stringify(progreso));
        refrescar();
      };

      grid.appendChild(div);
    });

    contenedor.appendChild(grid);
    return contenedor;
  }

  // Refresca todo el contenido al cambiar el estado
  function refrescar() {
    const contenedor = document.getElementById("contenedor-malla");
    contenedor.innerHTML = "";

    Object.entries(materiasPorAno).forEach(([ano, materias]) => {
      contenedor.appendChild(crearSeccion(ano, materias));
    });
  }

  // Inicializa
  refrescar();
</script>

</body>
</html>
